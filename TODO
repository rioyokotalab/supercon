Use Gmi
Use float
Unified memory
Remove THREADS
Forward declaration
